<!DOCTYPE html>
<html>
<head>
    

    

    


<!-- hexo-inject:begin --><!-- hexo-inject:end --><!-- Baidu Push -->
<script>
(function(){
    var bp = document.createElement('script');
    var curProtocol = window.location.protocol.split(':')[0];
    if (curProtocol === 'https') {
        bp.src = 'https://zz.bdstatic.com/linksubmit/push.js';
    }
    else {
        bp.src = 'http://push.zhanzhang.baidu.com/push.js';
    }
    var s = document.getElementsByTagName("script")[0];
    s.parentNode.insertBefore(bp, s);
})();
</script>
<!-- End Baidu Push -->


    <meta charset="utf-8">
    
    <meta name="google-site-verification" content="true">
    <meta name="baidu-site-verification" content="97dbRVWfVh" />
    <meta name="sogou_site_verification" content="AIePRXkUI4"/>
    
    
    <link rel="canonical" href="http://www.kotliner.cn/2017/01/16/用 Kotlin 写 Android 01 难道只有环境搭建这么简单/">
    
    
    <title>用 Kotlin 写 Android 01 难道只有环境搭建这么简单？ | Kotlin | 简洁、优雅，100% 兼容 Java</title>
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
    
    <meta name="theme-color" content="#3F51B5">
    
    
    <meta name="keywords" content="搭建环境,Anko,extensions">
    <meta name="description" content="从这周开始，每周一的文章推送将连载 Kotlin Android 开发的文章，大家有关心的题目也可以直接反馈给我，这样也可以帮助我提高后续文章的针对性。 亲爱的小伙伴，阅读本文之前，请确保你对 Kotlin 有一定的了解，并且你的 Android Studio 或者 IntelliJ Idea 已经安装了 Kotlin 的插件。如果没有，果断回去先看我的 Kotlin 视频 第一集 :) 1 千里">
<meta name="keywords" content="搭建环境,Anko,extensions">
<meta property="og:type" content="article">
<meta property="og:title" content="用 Kotlin 写 Android 01 难道只有环境搭建这么简单？">
<meta property="og:url" content="http://www.Kotliner.cn/2017/01/16/用 Kotlin 写 Android 01 难道只有环境搭建这么简单/index.html">
<meta property="og:site_name" content="Kotlin">
<meta property="og:description" content="从这周开始，每周一的文章推送将连载 Kotlin Android 开发的文章，大家有关心的题目也可以直接反馈给我，这样也可以帮助我提高后续文章的针对性。 亲爱的小伙伴，阅读本文之前，请确保你对 Kotlin 有一定的了解，并且你的 Android Studio 或者 IntelliJ Idea 已经安装了 Kotlin 的插件。如果没有，果断回去先看我的 Kotlin 视频 第一集 :) 1 千里">
<meta property="og:image" content="http://www.kotliner.cn/arts/kotlin扫码关注.png">
<meta property="og:updated_time" content="2017-05-22T02:30:56.921Z">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="用 Kotlin 写 Android 01 难道只有环境搭建这么简单？">
<meta name="twitter:description" content="从这周开始，每周一的文章推送将连载 Kotlin Android 开发的文章，大家有关心的题目也可以直接反馈给我，这样也可以帮助我提高后续文章的针对性。 亲爱的小伙伴，阅读本文之前，请确保你对 Kotlin 有一定的了解，并且你的 Android Studio 或者 IntelliJ Idea 已经安装了 Kotlin 的插件。如果没有，果断回去先看我的 Kotlin 视频 第一集 :) 1 千里">
<meta name="twitter:image" content="http://www.kotliner.cn/arts/kotlin扫码关注.png">
    
        <link rel="alternative" href="/atom.xml" title="Kotlin" type="application/atom+xml">
    
    <link rel="shortcut icon" href="/assets/img/favicon.ico">
    <link rel="stylesheet" href="/css/style.css?v=1.5.2">
    <script>window.lazyScripts=[]</script><!-- hexo-inject:begin --><!-- hexo-inject:end -->
</head>

<body>
    <!-- hexo-inject:begin --><!-- hexo-inject:end --><div id="loading" class="active"></div>

    <aside id="menu" class="hide" >
  <div class="inner flex-row-vertical">
    <a href="javascript:;" class="header-icon waves-effect waves-circle waves-light" id="menu-off">
        <i class="icon icon-lg icon-close"></i>
    </a>
    <div class="brand-wrap" style="background-image:url(/img/brand.jpg)">
      <div class="brand">
        <a href="/" class="avatar waves-effect waves-circle waves-light">
          <img src="/assets/img/Kotlin-logo.png">
        </a>
        <hgroup class="introduce">
          <h5 class="nickname">Kotlin</h5>
          <a href="mailto:kotlin@kotliner.cn" title="kotlin@kotliner.cn" class="mail">kotlin@kotliner.cn</a>
        </hgroup>
      </div>
    </div>
    <div class="scroll-wrap flex-col">
      <ul class="nav">
        
            <li class="waves-block waves-effect">
              <a href="/"  >
                <i class="icon icon-lg icon-home"></i>
                主页
              </a>
            </li>
        
            <li class="waves-block waves-effect">
              <a href="https://www.kotlincn.net"  >
                <i class="icon icon-lg icon-certificate"></i>
                官网
              </a>
            </li>
        
            <li class="waves-block waves-effect">
              <a href="/archives"  >
                <i class="icon icon-lg icon-archives"></i>
                所有文章
              </a>
            </li>
        
            <li class="waves-block waves-effect">
              <a href="/authors"  >
                <i class="icon icon-lg icon-user"></i>
                所有作者
              </a>
            </li>
        
            <li class="waves-block waves-effect">
              <a href="/tags"  >
                <i class="icon icon-lg icon-tags"></i>
                标签
              </a>
            </li>
        
            <li class="waves-block waves-effect">
              <a href="/categories"  >
                <i class="icon icon-lg icon-th-list"></i>
                分类
              </a>
            </li>
        
            <li class="waves-block waves-effect">
              <a href="/about"  >
                <i class="icon icon-lg icon-info"></i>
                关于我们
              </a>
            </li>
        
            <li class="waves-block waves-effect">
              <a href="/beijing/"  >
                <i class="icon icon-lg icon-map-marker beijing"></i>
                北京分会
              </a>
            </li>
        
            <li class="waves-block waves-effect">
              <a href="/chengdu/"  >
                <i class="icon icon-lg icon-map-marker chengdu"></i>
                成都分会
              </a>
            </li>
        
            <li class="waves-block waves-effect">
              <a href="http://shanghai.kotliner.cn"  >
                <i class="icon icon-lg icon-map-marker shanghai"></i>
                上海分会
              </a>
            </li>
        
      </ul>
    </div>
  </div>
</aside>

    <main id="main">
        <header class="top-header" id="header">
    <div class="flex-row">
        <a href="javascript:;" class="header-icon waves-effect waves-circle waves-light on" id="menu-toggle">
          <i class="icon icon-lg icon-navicon"></i>
        </a>
        <div class="flex-col header-title ellipsis">用 Kotlin 写 Android 01 难道只有环境搭建这么简单？</div>
        
        <div class="search-wrap" id="search-wrap">
            <a href="javascript:;" class="header-icon waves-effect waves-circle waves-light" id="back">
                <i class="icon icon-lg icon-chevron-left"></i>
            </a>
            <input type="text" id="key" class="search-input" autocomplete="off" placeholder="输入感兴趣的关键字">
            <a href="javascript:;" class="header-icon waves-effect waves-circle waves-light" id="search">
                <i class="icon icon-lg icon-search"></i>
            </a>
        </div>
        
        
        <a href="javascript:;" class="header-icon waves-effect waves-circle waves-light" id="menuShare">
            <i class="icon icon-lg icon-share-alt"></i>
        </a>
        
    </div>
</header>
<header class="content-header post-header">

    <div class="container fade-scale">
        <h1 class="title">用 Kotlin 写 Android 01 难道只有环境搭建这么简单？</h1>
        <h5 class="subtitle">
            
                <time datetime="2017-01-16T03:07:06.000Z" itemprop="datePublished" class="page-time">
  2017-01-16
</time>


	<ul class="article-category-list"><li class="article-category-list-item"><a class="article-category-list-link" href="/categories/Android/">Android</a></li></ul>

            
        </h5>
    </div>

    

</header>


<div class="container body-wrap">
    
    <aside class="post-widget">
        <nav class="post-toc-wrap" id="post-toc">
            <h4>TOC</h4>
            <ol class="post-toc"><li class="post-toc-item post-toc-level-2"><a class="post-toc-link" href="#1-千里之行，始于-Hello-World"><span class="post-toc-text">1 千里之行，始于 Hello World</span></a></li><li class="post-toc-item post-toc-level-2"><a class="post-toc-link" href="#2-Anko-已经超神"><span class="post-toc-text">2 Anko 已经超神</span></a></li><li class="post-toc-item post-toc-level-2"><a class="post-toc-link" href="#3-不要-findViewById"><span class="post-toc-text">3 不要 findViewById</span></a></li><li class="post-toc-item post-toc-level-2"><a class="post-toc-link" href="#4-小结"><span class="post-toc-text">4 小结</span></a></li></ol>
        </nav>
    </aside>
    

<article id="post-用 Kotlin 写 Android 01 难道只有环境搭建这么简单"
  class="post-article article-type-post fade" itemprop="blogPost">

    <div class="post-card">
        <h1 class="post-card-title">用 Kotlin 写 Android 01 难道只有环境搭建这么简单？</h1>
        <div class="post-meta">
            <time class="post-time" title="2017年01月16日 11:07" datetime="2017-01-16T03:07:06.000Z"  itemprop="datePublished">2017-01-16</time>

            
	<ul class="article-category-list"><li class="article-category-list-item"><a class="article-category-list-link" href="/categories/Android/">Android</a></li></ul>



            
<span id="busuanzi_container_page_pv" title="文章总阅读量" style='display:none'>
    <i class="icon icon-eye icon-pr"></i><span id="busuanzi_value_page_pv"></span>
</span>


            

        </div>
        <div class="post-content" id="post-content" itemprop="postContent">
            <p>从这周开始，每周一的文章推送将连载 Kotlin Android 开发的文章，大家有关心的题目也可以直接反馈给我，这样也可以帮助我提高后续文章的针对性。</p>
<p>亲爱的小伙伴，阅读本文之前，请确保你对 Kotlin 有一定的了解，并且你的 Android Studio 或者 IntelliJ Idea 已经安装了 Kotlin 的插件。如果没有，果断回去先看我的 <a href="https://github.com/enbandari/Kotlin-Tutorials" target="_blank" rel="external">Kotlin 视频</a> 第一集 :)</p>
<h2 id="1-千里之行，始于-Hello-World"><a href="#1-千里之行，始于-Hello-World" class="headerlink" title="1 千里之行，始于 Hello World"></a>1 千里之行，始于 Hello World</h2><p>话说我们入坑 Kotlin 之后，要怎样才能把它运用到 Android 开发当中呢？我们作为有经验的开发人员，大家都知道 Android 现在基本上都用 gradle 构建，gradle 构建过程中只要加入 Kotlin 代码编译的相关配置，那么 Kotlin 的代码运用到 Android 的问题就解决了。</p>
<p>这个问题有何难呢？Kotlin 团队早就帮我们把这个问题解决了，只要大家在 gradle 配置中加入：</p>
<figure class="highlight groovy"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">apply <span class="string">plugin:</span> <span class="string">'kotlin-android'</span></div></pre></td></tr></table></figure>
<p>就可以了，这与我们在普通 Java 虚拟机的程序的插件不太一样，其他的都差不多，比如我们需要在 buildScript 当中添加的 dependencies 与普通 Java虚拟机程序毫无二致：</p>
<figure class="highlight groovy"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div></pre></td><td class="code"><pre><div class="line">buildscript &#123;</div><div class="line">    ext.kotlin_version = <span class="string">'1.0.6'</span><span class="comment">//版本号根据实际情况选择</span></div><div class="line">    repositories &#123;</div><div class="line">        jcenter()</div><div class="line">    &#125;</div><div class="line">    dependencies &#123;</div><div class="line">        classpath <span class="string">'com.android.tools.build:gradle:2.2.0'</span></div><div class="line">        classpath <span class="string">"org.jetbrains.kotlin:kotlin-gradle-plugin:$kotlin_version"</span></div><div class="line">    &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>当然，我们还要在应用的 dependencies 当中添加 Kotlin 标准库：</p>
<figure class="highlight groovy"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">compile <span class="string">"org.jetbrains.kotlin:kotlin-stdlib:$kotlin_version"</span></div></pre></td></tr></table></figure>
<p>有了这些，你的 Kotlin 代码就可以跑在 Android 上面了！当然，你的代码写在 src/main/java 或是 src/main/kotlin 下都是可以的。这不重要了，我觉得把 Java 和 Kotlin 代码混着写就可以了，没必要分开，嗯，你最好不要感觉到他们是两个不同的语言，就酱紫。</p>
<figure class="highlight kotlin"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">package</span> net.println.kotlinandroiddemo</div><div class="line"></div><div class="line"><span class="keyword">import</span> android.os.Bundle</div><div class="line"><span class="keyword">import</span> android.support.v7.app.AppCompatActivity</div><div class="line"><span class="keyword">import</span> android.widget.TextView</div><div class="line"></div><div class="line"><span class="class"><span class="keyword">class</span> <span class="title">MainActivity</span> : <span class="type">AppCompatActivity</span></span>() &#123;</div><div class="line"></div><div class="line">    <span class="keyword">private</span> <span class="keyword">lateinit</span> <span class="keyword">var</span> textView: TextView</div><div class="line"></div><div class="line">    <span class="keyword">override</span> <span class="function"><span class="keyword">fun</span> <span class="title">onCreate</span><span class="params">(savedInstanceState: <span class="type">Bundle</span>?)</span></span> &#123;</div><div class="line">        <span class="keyword">super</span>.onCreate(savedInstanceState)</div><div class="line">        setContentView(R.layout.activity_main)</div><div class="line">        textView = findViewById(R.id.hello) <span class="keyword">as</span> TextView</div><div class="line">        textView.text = <span class="string">"Hello World"</span></div><div class="line">    &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>我们定义一个 TextView 的成员，由于我们只能在 onCreate 当中初始化这个成员，所以我们只好用 lateinit 来修饰它。当然，如果你不怕麻烦，你也可以选择 TextView? ，然后给这个成员初始化为 null。</p>
<p>接着我们就用最基本的写法 findViewById、类型强转拿到这个 textView 的引用，然后 setText。</p>
<p>运行自然是没有问题的。</p>
<p>不过，不过！我如果就写这么点儿就想糊弄过去这一周的文章，番茄鸡蛋砸过来估计够我吃一年的西红柿炒鸡蛋了吧（我~就~知~道~，我这一年不用愁吃的了！）</p>
<h2 id="2-Anko-已经超神"><a href="#2-Anko-已经超神" class="headerlink" title="2 Anko 已经超神"></a>2 Anko 已经超神</h2><p>要说用 Kotlin 写 Android，Anko 谁人不知谁人不晓，简直到了超神的地步。好好，咱们不吹牛了，赶紧把它老人家请出来：</p>
<figure class="highlight groovy"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">compile <span class="string">'org.jetbrains.anko:anko-sdk15:0.9'</span> <span class="comment">// sdk19, sdk21, sdk23 are also available</span></div><div class="line">compile <span class="string">'org.jetbrains.anko:anko-support-v4:0.9'</span> <span class="comment">// In case you need support-v4 bindings</span></div><div class="line">compile <span class="string">'org.jetbrains.anko:anko-appcompat-v7:0.9'</span> <span class="comment">// For appcompat-v7 bindings</span></div></pre></td></tr></table></figure>
<p>稍微提一句 anko-sdk 的版本选择：</p>
<ul>
<li>org.jetbrains.anko:anko-sdk15 ： 15 &lt;= minSdkVersion &lt; 19</li>
<li>org.jetbrains.anko:anko-sdk19 ： 19 &lt;= minSdkVersion &lt; 21</li>
<li>org.jetbrains.anko:anko-sdk21 ： 21 &lt;= minSdkVersion &lt; 23</li>
<li>org.jetbrains.anko:anko-sdk23 ： 23 &lt;= minSdkVersion</li>
</ul>
<p>当然除了这些之外，anko 还对 cardview、recyclerview等等做了支持，大家可以按需添加，详细可以参考 <a href="https://github.com/Kotlin/anko" target="_blank" rel="external">Github - Anko</a></p>
<p>另外，也建议大家用变量的形式定义 anko 库的版本，比如：</p>
<figure class="highlight groovy"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line">ext.anko_version = <span class="string">"0.9"</span></div><div class="line">...</div><div class="line"></div><div class="line">compile <span class="string">"org.jetbrains.anko:anko-sdk15:$anko_version"</span> <span class="comment">// sdk19, sdk21, sdk23 are also available</span></div><div class="line">compile <span class="string">"org.jetbrains.anko:anko-support-v4:$anko_version"</span> <span class="comment">// In case you need support-v4 bindings</span></div><div class="line">compile <span class="string">"org.jetbrains.anko:anko-appcompat-v7:$anko_version"</span> <span class="comment">// For appcompat-v7 bindings</span></div></pre></td></tr></table></figure>
<p>好，有了 Anko 我们能干什么呢？</p>
<figure class="highlight kotlin"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">textView = find(R.id.hello)</div></pre></td></tr></table></figure>
<p>还记得 findViewById 么？变成 find 了，而且强转也没有了，是不是很有趣？你一定有疑问，Anko 究竟干了啥，一下子省了这么多事儿，我们跳进去看看 find 的真面目：</p>
<figure class="highlight kotlin"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">inline</span> <span class="function"><span class="keyword">fun</span> <span class="type">&lt;<span class="keyword">reified</span> T : View&gt;</span> View.<span class="title">find</span><span class="params">(id: <span class="type">Int</span>)</span></span>: T = findViewById(id) <span class="keyword">as</span> T</div><div class="line"><span class="keyword">inline</span> <span class="function"><span class="keyword">fun</span> <span class="type">&lt;<span class="keyword">reified</span> T : View&gt;</span> Activity.<span class="title">find</span><span class="params">(id: <span class="type">Int</span>)</span></span>: T = findViewById(id) <span class="keyword">as</span> T</div><div class="line"><span class="keyword">inline</span> <span class="function"><span class="keyword">fun</span> <span class="type">&lt;<span class="keyword">reified</span> T : View&gt;</span> Fragment.<span class="title">find</span><span class="params">(id: <span class="type">Int</span>)</span></span>: T = view?.findViewById(id) <span class="keyword">as</span> T</div></pre></td></tr></table></figure>
<p>首先它是个扩展方法，我们暂时只用到了 Activity 的扩展版本，实际上 View、Fragment 都有这个扩展方法；其次，它是个 inline 方法，并且还用到了 reified 泛型参数，我们本来应该这么写：</p>
<figure class="highlight kotlin"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">textView = find&lt;TextView&gt;(R.id.hello)</div></pre></td></tr></table></figure>
<p>由于泛型参数的类型可以很容易的推导出来，所以我们再使用 find 的时候不需要显式的注明。</p>
<p>说到这里，其实还是有问题没有说清楚的，reified 究竟用来做什么？其实我们就算不写 inline 和 reified 泛型，这个方法照样是可以用的：</p>
<figure class="highlight kotlin"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">fun</span> <span class="type">&lt;T : View&gt;</span> Activity.<span class="title">myFind</span><span class="params">(id: <span class="type">Int</span>)</span></span>: T = findViewById(id) <span class="keyword">as</span> T</div></pre></td></tr></table></figure>
<figure class="highlight kotlin"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">textView = myFind(R.id.hello)</div></pre></td></tr></table></figure>
<p>不过呢，这地方用 inline 就省了一次函数调用，并且 reified 也可以消除 IDE 的类型检查提示，所以既然可以，为什么不呢？</p>
<p>当然，用 Anko 的好处不可能就这么点儿，我们今天先按住不说，谁好奇的话可以先自己去看看（我~就~知~道~，你们肯定忍不住！！）~</p>
<h2 id="3-不要-findViewById"><a href="#3-不要-findViewById" class="headerlink" title="3 不要 findViewById"></a>3 不要 findViewById</h2><p>作为第一篇介绍 Kotlin 写 Android 的文章，绝对不能少的就是 kotlin-android-extensions 插件了。在 gradle 当中加配置：</p>
<figure class="highlight groovy"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">apply <span class="string">plugin:</span> <span class="string">'kotlin-android-extensions'</span></div></pre></td></tr></table></figure>
<p>之后，我们只需要在 Activity 的代码当中直接使用在布局中定义的 id 为 hello 的这个 textView，于是：</p>
<figure class="highlight kotlin"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">import</span> android.os.Bundle</div><div class="line"><span class="keyword">import</span> android.support.v7.app.AppCompatActivity</div><div class="line"></div><div class="line"><span class="comment">//这个包会自动导入</span></div><div class="line"><span class="keyword">import</span> kotlinx.android.synthetic.main.activity_main.*</div><div class="line"></div><div class="line"><span class="class"><span class="keyword">class</span> <span class="title">MainActivity</span> : <span class="type">AppCompatActivity</span></span>() &#123;</div><div class="line"></div><div class="line">    <span class="keyword">override</span> <span class="function"><span class="keyword">fun</span> <span class="title">onCreate</span><span class="params">(savedInstanceState: <span class="type">Bundle</span>?)</span></span> &#123;</div><div class="line">        <span class="keyword">super</span>.onCreate(savedInstanceState)</div><div class="line">        setContentView(R.layout.activity_main)</div><div class="line">        <span class="comment">//直接使用 hello，hello 实际上是这个view 在布局当中的id</span></div><div class="line">        hello.text = <span class="string">"Hello World"</span></div><div class="line">    &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>只要布局添加一个 View，在 Activity、View、Fragment 中其实都可以直接用 id 来引用这个 view，超级爽~</p>
<p>所以，你们不准备问下这是为什么吗？为什么可以这样做呢？</p>
<p>其实要回答这个问题也不难，首先 Android Studio 要能够从 IDE 的层面索引到 hello 这个 View，需要 Kotlin 的 IDE 插件的支持（别问我啥是 IDE 插件，你们用 Kotlin 的第一天肯定都装过）；其次，在编译的时候，编译器能够找到 hello 这个变量，那么还需要 Kotlin 的 gradle 插件支持（我们刚刚好像 apply 了个什么 plugin 来着？）。知道了这两点，我们就要有的放矢了~</p>
<blockquote>
<p>“啊！” 那边的 Kotlin 源码一声惨叫。。。</p>
</blockquote>
<p>前方高能。。我们讨论的源码主要在 plugins 目录下的 android-extensions-compiler 和 android-extensions-idea 两个模块当中。</p>
<p>如果让大家自己实现一套机制来完成上面的功能，大家肯定会想，我首先得解析一下 XML 布局文件吧，并把里面的 View 存起来，这样方便后面的查找。我告诉大家，Kotlin 也是这么干的！</p>
<p><strong>AndroidXmlVisitor.kt</strong></p>
<figure class="highlight kotlin"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">override</span> <span class="function"><span class="keyword">fun</span> <span class="title">visitXmlTag</span><span class="params">(tag: <span class="type">XmlTag</span>?)</span></span> &#123;</div><div class="line">	...</div><div class="line"></div><div class="line">    <span class="keyword">val</span> idAttribute = tag?.getAttribute(AndroidConst.ID_ATTRIBUTE)</div><div class="line">    <span class="keyword">if</span> (idAttribute != <span class="literal">null</span>) &#123;</div><div class="line">        <span class="keyword">val</span> idAttributeValue = idAttribute.value</div><div class="line">        <span class="keyword">if</span> (idAttributeValue != <span class="literal">null</span>) &#123;</div><div class="line">            <span class="keyword">val</span> xmlType = tag?.getAttribute(AndroidConst.CLASS_ATTRIBUTE_NO_NAMESPACE)?.value ?: localName</div><div class="line">            <span class="keyword">val</span> name = androidIdToName(idAttributeValue)</div><div class="line">            <span class="keyword">if</span> (name != <span class="literal">null</span>) elementCallback(name, xmlType, idAttribute)</div><div class="line">        &#125;</div><div class="line">    &#125;</div><div class="line">    tag?.acceptChildren(<span class="keyword">this</span>)</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>这是遍历 XML 标签的代码，典型的访问者模式对吧。如果拿到这个标签，它有 android:id 这个属性，那么小样儿，你别走，老实交代你的 id 是什么！举个例子，如果这个标签是这样的：</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line"><span class="tag">&lt;<span class="name">Button</span></span></div><div class="line">    <span class="attr">android:id</span>=<span class="string">"@+id/login"</span></div><div class="line">	<span class="attr">...</span> /&gt;</div></pre></td></tr></table></figure>
<p>那么，name 就是 login 了，既然 name 不为空，那么调用 elementCallback，其实就是把它记录了下来。</p>
<p><strong>IDEAndroidLayoutXmlFileManager.kt</strong></p>
<figure class="highlight kotlin"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">override</span> <span class="function"><span class="keyword">fun</span> <span class="title">doExtractResources</span><span class="params">(files: <span class="type">List</span>&lt;<span class="type">PsiFile</span>&gt;, module: <span class="type">ModuleDescriptor</span>)</span></span>: List&lt;AndroidResource&gt; &#123;</div><div class="line">    <span class="keyword">val</span> widgets = arrayListOf&lt;AndroidResource&gt;()</div><div class="line">    </div><div class="line">    <span class="comment">//注意到这里的 Lambda 表达式就是前面的 elementCallback</span></div><div class="line">    <span class="keyword">val</span> visitor = AndroidXmlVisitor &#123; id, widgetType, attribute -&gt;</div><div class="line">        widgets += parseAndroidResource(id, widgetType, attribute.valueElement)</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    files.forEach &#123; it.accept(visitor) &#125;</div><div class="line">    </div><div class="line">    <span class="comment">//返回所有带 id 的 view</span></div><div class="line">    <span class="keyword">return</span> widgets</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>接着想既然我们找到了所有的布局带有 id 的 view，那么我们总得想办法让 Activity 它们找到这些 view 才行对吧，而我们发现其实在引用它们的时候总是要导入一个包，包名叫做：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">kotlinx.android.synthetic.main.&lt;布局文件名&gt;.*</div></pre></td></tr></table></figure>
<p>几个意思？Kotlin 编译器为我们创建了一个包？</p>
<p><strong>AndroidPackageFragmentProviderExtension.kt</strong></p>
<figure class="highlight kotlin"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line">...</div><div class="line">createPackageFragment(packageFqName, <span class="literal">false</span>)</div><div class="line">createPackageFragment(packageFqName + <span class="string">".view"</span>, <span class="literal">true</span>)</div><div class="line">...</div></pre></td></tr></table></figure>
<p>注意到，这里的 packageFqName 其实就是我们前面提到的</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">kotlinx.android.synthetic.main.&lt;布局文件名&gt;</div></pre></td></tr></table></figure>
<p>不对呀，怎么创建了两个包呢？其实第二个多了个 .view ，我们在 Activity 当中 导入的包是第一个，但如果是我们用父 view 引用子 view 时，用的是第二个：</p>
<figure class="highlight kotlin"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div></pre></td><td class="code"><pre><div class="line">...</div><div class="line"><span class="keyword">import</span> kotlinx.android.synthetic.main.activity_main.view.*</div><div class="line"></div><div class="line"><span class="class"><span class="keyword">class</span> <span class="title">OverlayManager</span></span>(context: Context)&#123;</div><div class="line">    init &#123;</div><div class="line">        <span class="keyword">val</span> view = LayoutInflater.from(context).inflate(R.layout.activity_main, <span class="literal">null</span>)</div><div class="line">        view.hello.text = <span class="string">"HelloWorld"</span></div><div class="line">        ...</div><div class="line">    &#125;</div><div class="line">    </div><div class="line">    ...</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>好，我们现在知道了，IntelliJ 居然已经通过解析 XML 帮我们偷偷搞出了这么两个虚拟的包，这样我们在代码当中能够引用到这个包就很容易解释了。</p>
<p>这时候可能还会有人比较疑惑点击了 Activity 的 hello 之后如何跳转到 XML 的，这个大家阅读一下 <figure class="highlight plain"><figcaption><span>的源码就会很容易的看到答案。</span></figcaption><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line"></div><div class="line">费了这么多篇幅，其实我们只是做好了表面文章。上面的一切其实都是障眼法，别管怎么说，这两个包都是虚拟的，编译的时候该怎么办？</div><div class="line"></div><div class="line">其实编译就简单多了，碰到这样的引用，比如前面的 hello，直接生成 findViewById 的字节码就可以了，我们把 ```hello.text = &quot;HelloWorld&quot;``` 的字节码贴出来给大家看：</div></pre></td></tr></table></figure></p>
<p>L2<br>LINENUMBER 12 L2<br>ALOAD 0<br>GETSTATIC net/println/kotlinandroiddemo/R$id.hello : I<br>INVOKEVIRTUAL net/println/kotlinandroiddemo/MainActivity._$_findCachedViewById (I)Landroid/view/View;<br>CHECKCAST android/widget/TextView<br>LDC “Hello World”<br>CHECKCAST java/lang/CharSequence<br>INVOKEVIRTUAL android/widget/TextView.setText (Ljava/lang/CharSequence;)V<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div></pre></td><td class="code"><pre><div class="line"></div><div class="line">这个是怎么做到的？请大家阅读 ```AndroidExpressionCodegenExtension.kt```，</div><div class="line"></div><div class="line">```kotlin</div><div class="line">...</div><div class="line">//GETSTATIC net/println/kotlinandroiddemo/R$id.hello : I</div><div class="line">v.getstatic(packageName.replace(&quot;.&quot;, &quot;/&quot;) + &quot;/R\$id&quot;, resourceId.name, &quot;I&quot;)</div><div class="line">    </div><div class="line">//INVOKEVIRTUAL net/println/kotlinandroiddemo/MainActivity._$_findCachedViewById (I)Landroid/view/View;</div><div class="line">v.invokevirtual(declarationDescriptorType.internalName, </div><div class="line">	CACHED_FIND_VIEW_BY_ID_METHOD_NAME, </div><div class="line">	&quot;(I)Landroid/view/View;&quot;, false)</div><div class="line">...</div></pre></td></tr></table></figure></p>
<p>好，到这里，想必大家才能对 Android 的 HelloWorld 代码有一个彻底的理解。</p>
<h2 id="4-小结"><a href="#4-小结" class="headerlink" title="4 小结"></a>4 小结</h2><p>虽然是 HelloWorld，但要想搞清楚其中的所有秘密，并没有那么简单，很多时候，阅读 Kotlin 源码几乎成了唯一的途径。</p>
<p>谢谢大家的关注和支持~如果有什么问题可以联系我~</p>
<figure class="image-bubble">
                <div class="img-lightbox">
                    <div class="overlay"></div>
                    <img src="/arts/kotlin扫码关注.png" alt="" title="">
                </div>
                <div class="image-caption"></div>
            </figure>

        </div>

        <blockquote class="post-copyright">
    <div class="content">
        
<span class="post-time">
    最后更新时间：<time datetime="2017-05-22T02:30:56.921Z" itemprop="dateUpdated">2017年5月22日 10:30</time>
</span><br>


        
        转载请注明出处：<a href="/2017/01/16/用 Kotlin 写 Android 01 难道只有环境搭建这么简单/ " target="_blank" rel="external">http://www.Kotliner.cn/2017/01/16/用 Kotlin 写 Android 01 难道只有环境搭建这么简单/</a>
        
    </div>
    <footer>
        <div>
            <a href="/authors/bennyhuo/">
                
                <img src="/assets/img/Kotlin-logo.png" alt="Kotlin">
                
                bennyhuo
                
            </a>
            
        </div>
    </footer>
</blockquote>

        
<div class="page-reward">
    <a id="rewardBtn" href="javascript:;" class="page-reward-btn waves-effect waves-circle waves-light">赏</a>
</div>



        <div class="post-footer">
            
	<ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/Anko/">Anko</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/extensions/">extensions</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/搭建环境/">搭建环境</a></li></ul>


            
<div class="page-share-wrap">
    

<div class="page-share" id="pageShare">
    <ul class="reset share-icons">
      <li>
        <a class="weibo share-sns" target="_blank" href="http://service.weibo.com/share/share.php?url=http://www.Kotliner.cn/2017/01/16/用 Kotlin 写 Android 01 难道只有环境搭建这么简单/&title=《用 Kotlin 写 Android 01 难道只有环境搭建这么简单？》 — Kotlin&pic=http://www.Kotliner.cn/assets/img/Kotlin-logo.png" data-title="微博">
          <i class="icon icon-weibo"></i>
        </a>
      </li>
      <li>
        <a class="weixin share-sns wxFab" href="javascript:;" data-title="微信">
          <i class="icon icon-weixin"></i>
        </a>
      </li>
      <li>
        <a class="qq share-sns" target="_blank" href="http://connect.qq.com/widget/shareqq/index.html?url=http://www.Kotliner.cn/2017/01/16/用 Kotlin 写 Android 01 难道只有环境搭建这么简单/&title=《用 Kotlin 写 Android 01 难道只有环境搭建这么简单？》 — Kotlin&source=Kotlin 是一门由 JetBrains 公司开发的运行在 JVM、Android、前端的静态语言，它 100% 兼容 Java，并且开始逐步支持 Na..." data-title=" QQ">
          <i class="icon icon-qq"></i>
        </a>
      </li>
      <li>
        <a class="facebook share-sns" target="_blank" href="https://www.facebook.com/sharer/sharer.php?u=http://www.Kotliner.cn/2017/01/16/用 Kotlin 写 Android 01 难道只有环境搭建这么简单/" data-title=" Facebook">
          <i class="icon icon-facebook"></i>
        </a>
      </li>
      <li>
        <a class="twitter share-sns" target="_blank" href="https://twitter.com/intent/tweet?text=《用 Kotlin 写 Android 01 难道只有环境搭建这么简单？》 — Kotlin&url=http://www.Kotliner.cn/2017/01/16/用 Kotlin 写 Android 01 难道只有环境搭建这么简单/&via=http://www.Kotliner.cn" data-title=" Twitter">
          <i class="icon icon-twitter"></i>
        </a>
      </li>
      <li>
        <a class="google share-sns" target="_blank" href="https://plus.google.com/share?url=http://www.Kotliner.cn/2017/01/16/用 Kotlin 写 Android 01 难道只有环境搭建这么简单/" data-title=" Google+">
          <i class="icon icon-google-plus"></i>
        </a>
      </li>
    </ul>
 </div>



    <a href="javascript:;" id="shareFab" class="page-share-fab waves-effect waves-circle">
        <i class="icon icon-share-alt icon-lg"></i>
    </a>
</div>



        </div>
    </div>

    
<nav class="post-nav flex-row flex-justify-between">
  
    <div class="waves-block waves-effect prev">
      <a href="/2017/01/21/喜大普奔！Kotlin 1.1 Beta 降临~/" id="post-prev" class="post-nav-link">
        <div class="tips"><i class="icon icon-angle-left icon-lg icon-pr"></i> Prev</div>
        <h4 class="title">喜大普奔！Kotlin 1.1 Beta 降临~</h4>
      </a>
    </div>
  

  
    <div class="waves-block waves-effect next">
      <a href="/2017/01/09/高效地使用你的 IntelliJ/" id="post-next" class="post-nav-link">
        <div class="tips">Next <i class="icon icon-angle-right icon-lg icon-pl"></i></div>
        <h4 class="title">高效地使用你的 IntelliJ</h4>
      </a>
    </div>
  
</nav>



    










<div class="comments" id="comments">
<div id="cloud-tie-wrapper" class="cloud-tie-wrapper"></div>
</div>
<script>
    var cloudTieConfig = {
        url: document.location.href,
        sourceId: "",
        productKey: "0263eabe3b1b46709556eda1c39750be",
        target: "cloud-tie-wrapper"
    };
</script>
<script src="https://img1.cache.netease.com/f2e/tie/yun/sdk/loader.js"></script>




</article>

<div id="reward" class="page-modal reward-lay">
    <a class="close" href="javascript:;"><i class="icon icon-close"></i></a>
    <h3 class="reward-title">
        <i class="icon icon-quote-left"></i>
        Have a nice Kotlin!
        <i class="icon icon-quote-right"></i>
    </h3>
    <ul class="reward-items">
        
        
        <li>
            <img src="/assets/img/wechat.jpg" title="微信打赏二维码" alt="微信打赏二维码">
            <p>微信</p>
        </li>
        

        
        <li>
            <img src="/assets/img/alipay.jpg" title="支付宝打赏二维码" alt="支付宝打赏二维码">
            <p>支付宝</p>
        </li>
        
    </ul>
</div>



</div>

        <footer class="footer">
    <div class="top">
        
<p>
    <span id="busuanzi_container_site_uv" style='display:none'>
        站点总访客数：<span id="busuanzi_value_site_uv"></span>
    </span>
    <span id="busuanzi_container_site_pv" style='display:none'>
        站点总访问量：<span id="busuanzi_value_site_pv"></span>
    </span>
</p>


        <p>
            <span><a href="/atom.xml" target="_blank" class="rss" title="rss"><i class="icon icon-lg icon-rss"></i></a></span>
            <span>博客内容遵循 <a href="http://creativecommons.org/licenses/by-nc-sa/4.0/" target="_blank">知识共享 署名 - 非商业性 - 相同方式共享 4.0协议</a></span>
        </p>
    </div>
    <div class="bottom">
        <p>
            <span class="copyright-text">京ICP备16022265号-2&nbsp;</span>
            <span>Kotlin &copy; 2017</span>
        </p>
        <p>
            本站由<a style="display:inline" href="https://account.ucloud.cn/cas/register?utm_source=kotliner&utm_medium=content_pic_pc&utm_campaign=zanzhu&ytag=kotliner">UCloud 提供赞助 - 注册即送 50 元代金券</a>
        </p>
        <p>
            <span>Power by <a href="http://hexo.io/" target="_blank">Hexo</a> Theme <a href="https://github.com/yscoder/hexo-theme-indigo" target="_blank">indigo</a></span>
        </p>
    </div>
</footer>

    </main>
    <div class="mask" id="mask"></div>
<a href="javascript:;" id="gotop" class="waves-effect waves-circle waves-light"><span class="icon icon-lg icon-chevron-up"></span></a>



<div class="global-share" id="globalShare">
    <ul class="reset share-icons">
      <li>
        <a class="weibo share-sns" target="_blank" href="http://service.weibo.com/share/share.php?url=http://www.Kotliner.cn/2017/01/16/用 Kotlin 写 Android 01 难道只有环境搭建这么简单/&title=《用 Kotlin 写 Android 01 难道只有环境搭建这么简单？》 — Kotlin&pic=http://www.Kotliner.cn/assets/img/Kotlin-logo.png" data-title="微博">
          <i class="icon icon-weibo"></i>
        </a>
      </li>
      <li>
        <a class="weixin share-sns wxFab" href="javascript:;" data-title="微信">
          <i class="icon icon-weixin"></i>
        </a>
      </li>
      <li>
        <a class="qq share-sns" target="_blank" href="http://connect.qq.com/widget/shareqq/index.html?url=http://www.Kotliner.cn/2017/01/16/用 Kotlin 写 Android 01 难道只有环境搭建这么简单/&title=《用 Kotlin 写 Android 01 难道只有环境搭建这么简单？》 — Kotlin&source=Kotlin 是一门由 JetBrains 公司开发的运行在 JVM、Android、前端的静态语言，它 100% 兼容 Java，并且开始逐步支持 Na..." data-title=" QQ">
          <i class="icon icon-qq"></i>
        </a>
      </li>
      <li>
        <a class="facebook share-sns" target="_blank" href="https://www.facebook.com/sharer/sharer.php?u=http://www.Kotliner.cn/2017/01/16/用 Kotlin 写 Android 01 难道只有环境搭建这么简单/" data-title=" Facebook">
          <i class="icon icon-facebook"></i>
        </a>
      </li>
      <li>
        <a class="twitter share-sns" target="_blank" href="https://twitter.com/intent/tweet?text=《用 Kotlin 写 Android 01 难道只有环境搭建这么简单？》 — Kotlin&url=http://www.Kotliner.cn/2017/01/16/用 Kotlin 写 Android 01 难道只有环境搭建这么简单/&via=http://www.Kotliner.cn" data-title=" Twitter">
          <i class="icon icon-twitter"></i>
        </a>
      </li>
      <li>
        <a class="google share-sns" target="_blank" href="https://plus.google.com/share?url=http://www.Kotliner.cn/2017/01/16/用 Kotlin 写 Android 01 难道只有环境搭建这么简单/" data-title=" Google+">
          <i class="icon icon-google-plus"></i>
        </a>
      </li>
    </ul>
 </div>


<div class="page-modal wx-share" id="wxShare">
    <a class="close" href="javascript:;"><i class="icon icon-close"></i></a>
    <p>扫一扫，分享到微信</p>
    <img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAPYAAAD2CAAAAADAeSUUAAADJElEQVR42u3aUW7cMAwFwL3/pbcHSOM8klpgTY+/isS1NTJQlo96veLrfXn9vPP6Ob/d+fOZyfOv3zi6sLGxsW/CTkjV5V5Tr3+SIK/XmXwebGxs7H3s6nJ/e021mFWffP2WfPuwsbGxn8zOC8b8ydebhY2NjY1dZSfNQNKiJJvYo2JjY2M/mZ2HNckSe81Gb7Tw8SwNGxsb++vZ+VT0+//8kfk2NjY29hez360rKWm95qE3AC6vHxsbG3sR+xOLqMZDvdho8mGwsbGx97Gr4Dwqmhy+rBaw/KgQNjY29iZ2Eu5PjtpMGobJ9cf6sbGxsZey8xLVKyFRYxDc3xsw/ydLw8bGxl7EzhfdW2LekPTeWB5FYGNjYy9i57FOtQnpHfqpvrcXSGFjY2PvZudD095gON+syVA5+hjY2NjY69i9LUhKxXyhZ9+FjY2NvYndi3LOxv35QaJ806MsDRsbG3sFuwo71TD0SuO8jXn1vic2Njb2F7Or/9BXBwbJ//zzRuVYRIWNjY29iJ2Pe0/FSWffeCD2wsbGxr45uxcJ5U3FZBicJ/nlD4ONjY29lP252Ki3lfMhMTY2NjZ2byMmx3Hy9qMaP2FjY2NvZecRT6/lmDck1eCpqsPGxsa+OzspRdXf9hqYXnFtbgo2Njb2InZ1mFpderLQyfg2j6sKmRY2Njb2zdm9oW91bNALlapxUlS9sbGxsR/AzpdbbW/y7egV1D/uxMbGxl7B7h3Hub5/HidN2pto9IuNjY29lJ0ffzwb7leLVq8JeSXTA2xsbOwbsvPBbV6EJi1KdYtHQwtsbGzsFezeYZdT44Hez3tHdrCxsbG3sq9vqi6ld7wmX0n+nKg8Y2NjY69gv4tXL8Tp/bb6/MIgGRsbG3sRe1798nFCXpBObWs+5MDGxsa+O7tXtJKFXj8zn2Dkx0MLERg2Njb2OnYe8eRD4nyQMDn6k2xWNBvBxsbGfgA7P1JTjXiqA+YDIwRsbGzsR7Lzv9Vj947pNJscbGxs7HXsPFSqDlOrW9b7AOXGBhsbG3sRu/r/9qSdmMdGva0/G0thY2Njfz37H7qOv4Nc1xNzAAAAAElFTkSuQmCC" alt="微信分享二维码">
</div>




    <script src="//cdn.bootcss.com/node-waves/0.7.4/waves.min.js"></script>
<script>
var BLOG = { ROOT: '/', SHARE: true, REWARD: true };



lazyScripts.push('//s95.cnzz.com/z_stat.php?id=1261686164&web_id=1261686164')

</script>

<script src="/js/main.min.js?v=1.5.2"></script>


<div class="search-panel" id="search-panel">
    <ul class="search-result" id="search-result"></ul>
</div>
<template id="search-tpl">
<li class="item">
    <a href="{path}" class="waves-block waves-effect">
        <div class="title ellipsis" title="{title}">{title}</div>
        <div class="flex-row flex-middle">
            <div class="tags ellipsis">
                {tags}
            </div>
            <time class="flex-col time">{date}</time>
        </div>
    </a>
</li>
</template>

<script src="/js/search.min.js?v=1.5.2" async></script>





<script async src="//dn-lbstatics.qbox.me/busuanzi/2.3/busuanzi.pure.mini.js"></script>



<script>
(function() {
    var OriginTitile = document.title, titleTime;
    document.addEventListener('visibilitychange', function() {
        if (document.hidden) {
            document.title = 'Kotlin 博客';
            clearTimeout(titleTime);
        } else {
            document.title = 'Kotlin 博客';
            titleTime = setTimeout(function() {
                document.title = OriginTitile;
            },2000);
        }
    });
})();
</script><!-- hexo-inject:begin --><!-- Begin: Injected MathJax -->
<script type="text/x-mathjax-config">
  MathJax.Hub.Config({"tex2jax":{"inlineMath":[["$","$"],["\\(","\\)"]],"skipTags":["script","noscript","style","textarea","pre","code"],"processEscapes":true},"TeX":{"equationNumbers":{"autoNumber":"AMS"}}});
</script>

<script type="text/x-mathjax-config">
  MathJax.Hub.Queue(function() {
    var all = MathJax.Hub.getAllJax(), i;
    for(i=0; i < all.length; i += 1) {
      all[i].SourceElement().parentNode.className += ' has-jax';
    }
  });
</script>

<script type="text/javascript" src="//cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML">
</script>
<!-- End: Injected MathJax -->
<!-- hexo-inject:end -->



</body>
</html>
